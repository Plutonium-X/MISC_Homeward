EXTEND_BOTTOM FATESP 6
+ ~InParty("Aerie") InMyArea("Aerie") !StateCheck("Aerie",CD_STATE_NOTVALID)~ + @0 DO ~SetGlobal("B!AerieSentHome","GLOBAL",1) 
    ActionOverride("Aerie",SetGlobal("KickedOut","LOCALS",1)) 
    ActionOverride("Aerie",SetLeavePartyDialogFile()) 
    ActionOverride("Aerie",ChangeAIScript("",DEFAULT)) 
    ActionOverride("Aerie",LeaveParty())
    ActionOverride("Aerie",GivePartyAllEquipment())
    ActionOverride("Aerie",MakeGlobal())
    Wait(1)
    CreateVisualEffectObject("SPDIMNDR","Aerie")
    Wait(4)
    MoveGlobal("AR0607","Aerie",[272.294])~ EXIT
+ ~InParty("Anomen") InMyArea("Anomen") !StateCheck("Anomen",CD_STATE_NOTVALID)~ + @1 DO ~SetGlobal("B!AnomenSentHome","GLOBAL",1) 
    ActionOverride("Anomen",SetGlobal("KickedOut","LOCALS",1)) 
    ActionOverride("Anomen",SetLeavePartyDialogFile()) 
    ActionOverride("Anomen",ChangeAIScript("",DEFAULT)) 
    ActionOverride("Anomen",LeaveParty())
    ActionOverride("Anomen",GivePartyAllEquipment())
    ActionOverride("Anomen",MakeGlobal())
    Wait(1)
    CreateVisualEffectObject("SPDIMNDR","Anomen")
    Wait(4)
    MoveGlobal("AR0903","Anomen",[1572.366])~ EXIT
+ ~InParty("Cernd") InMyArea("Cernd") !StateCheck("Cernd",CD_STATE_NOTVALID)~ + @2 DO ~SetGlobal("B!CerndSentHome","GLOBAL",1) 
    ActionOverride("Cernd",SetGlobal("KickedOut","LOCALS",1)) 
    ActionOverride("Cernd",SetLeavePartyDialogFile()) 
    ActionOverride("Cernd",ChangeAIScript("",DEFAULT)) 
    ActionOverride("Cernd",LeaveParty())
    ActionOverride("Cernd",GivePartyAllEquipment())
    ActionOverride("Cernd",MakeGlobal())
    Wait(1)
    CreateVisualEffectObject("SPDIMNDR","Cernd")
    Wait(4)
    MoveGlobal("AR1901","Cernd",[548.655])~ EXIT
+ ~InParty("Edwin") InMyArea("Edwin") !StateCheck("Edwin",CD_STATE_NOTVALID)~ + @3 DO ~SetGlobal("B!EdwinSentHome","GLOBAL",1) 
    ActionOverride("Edwin",SetGlobal("KickedOut","LOCALS",1)) 
    ActionOverride("Edwin",SetLeavePartyDialogFile()) 
    ActionOverride("Edwin",ChangeAIScript("",DEFAULT)) 
    ActionOverride("Edwin",LeaveParty())
    ActionOverride("Edwin",GivePartyAllEquipment())
    ActionOverride("Edwin",MakeGlobal())
    Wait(1)
    CreateVisualEffectObject("SPDIMNDR","Edwin")
    Wait(4)
    MoveGlobal("AR0406","Edwin",[673.1104])~ EXIT
+ ~InParty("HaerDalis") InMyArea("HaerDalis") !StateCheck("HaerDalis",CD_STATE_NOTVALID)~ + @4 DO ~SetGlobal("B!HaerDalisSentHome","GLOBAL",1) 
    ActionOverride("HaerDalis",SetGlobal("KickedOut","LOCALS",1)) 
    ActionOverride("HaerDalis",SetLeavePartyDialogFile()) 
    ActionOverride("HaerDalis",ChangeAIScript("",DEFAULT)) 
    ActionOverride("HaerDalis",LeaveParty())
    ActionOverride("HaerDalis",GivePartyAllEquipment())
    ActionOverride("HaerDalis",MakeGlobal())
    Wait(1)
    CreateVisualEffectObject("SPDIMNDR","HaerDalis")
    Wait(4)
    MoveGlobal("AR0523","HaerDalis",[826.616])~ EXIT
+ ~InParty("Imoen2") InMyArea("Imoen2") !StateCheck("Imoen2",CD_STATE_NOTVALID)~ + @5 DO ~SetGlobal("B!Imoen2SentHome","GLOBAL",1) 
    ActionOverride("Imoen2",SetGlobal("KickedOut","LOCALS",1)) 
    ActionOverride("Imoen2",SetLeavePartyDialogFile()) 
    ActionOverride("Imoen2",ChangeAIScript("",DEFAULT)) 
    ActionOverride("Imoen2",LeaveParty())
    ActionOverride("Imoen2",GivePartyAllEquipment())
    ActionOverride("Imoen2",MakeGlobal())
    Wait(1)
    CreateVisualEffectObject("SPDIMNDR","Imoen2")
    Wait(4)
    MoveGlobal("AR0406","Imoen2",[1457.1901])~ EXIT
+ ~InParty("Jaheira") InMyArea("Jaheira") !StateCheck("Jaheira",CD_STATE_NOTVALID)~ + @6 DO ~SetGlobal("B!JaheiraSentHome","GLOBAL",1) 
    ActionOverride("Jaheira",SetGlobal("KickedOut","LOCALS",1)) 
    ActionOverride("Jaheira",SetLeavePartyDialogFile()) 
    ActionOverride("Jaheira",ChangeAIScript("",DEFAULT)) 
    ActionOverride("Jaheira",LeaveParty())
    ActionOverride("Jaheira",GivePartyAllEquipment())
    ActionOverride("Jaheira",MakeGlobal())
    Wait(1)
    CreateVisualEffectObject("SPDIMNDR","Jaheira")
    Wait(4)
    MoveGlobal("AR0308","Jaheira",[985.951])~ EXIT
+ ~InParty("Jan") InMyArea("Jan") !StateCheck("Jan",CD_STATE_NOTVALID)~ + @7 DO ~SetGlobal("B!JanSentHome","GLOBAL",1) 
    ActionOverride("Jan",SetGlobal("KickedOut","LOCALS",1)) 
    ActionOverride("Jan",SetLeavePartyDialogFile()) 
    ActionOverride("Jan",ChangeAIScript("",DEFAULT)) 
    ActionOverride("Jan",LeaveParty())
    ActionOverride("Jan",GivePartyAllEquipment())
    ActionOverride("Jan",MakeGlobal())
    Wait(1)
    CreateVisualEffectObject("SPDIMNDR","Jan")
    Wait(4)
    MoveGlobal("AR0402","Jan",[226.292])~ EXIT
+ ~InParty("Keldorn") InMyArea("Keldorn") !StateCheck("Keldorn",CD_STATE_NOTVALID)~ + @8 DO ~SetGlobal("B!KeldornSentHome","GLOBAL",1) 
    ActionOverride("Keldorn",SetGlobal("KickedOut","LOCALS",1)) 
    ActionOverride("Keldorn",SetLeavePartyDialogFile()) 
    ActionOverride("Keldorn",ChangeAIScript("",DEFAULT)) 
    ActionOverride("Keldorn",LeaveParty())
    ActionOverride("Keldorn",GivePartyAllEquipment())
    ActionOverride("Keldorn",MakeGlobal())
    Wait(1)
    CreateVisualEffectObject("SPDIMNDR","Keldorn")
    Wait(4)
    MoveGlobal("AR1003","Keldorn",[595.453])~ EXIT
+ ~InParty("Korgan") InMyArea("Korgan") !StateCheck("Korgan",CD_STATE_NOTVALID)~ + @9 DO ~SetGlobal("B!KorganSentHome","GLOBAL",1) 
    ActionOverride("Korgan",SetGlobal("KickedOut","LOCALS",1)) 
    ActionOverride("Korgan",SetLeavePartyDialogFile()) 
    ActionOverride("Korgan",ChangeAIScript("",DEFAULT)) 
    ActionOverride("Korgan",LeaveParty())
    ActionOverride("Korgan",GivePartyAllEquipment())
    ActionOverride("Korgan",MakeGlobal())
    Wait(1)
    CreateVisualEffectObject("SPDIMNDR","Korgan")
    Wait(4)
    MoveGlobal("AR0406","Korgan",[941.1837])~ EXIT
+ ~InParty("Mazzy") InMyArea("Mazzy") !StateCheck("Mazzy",CD_STATE_NOTVALID)~ + @10 DO ~SetGlobal("B!MazzySentHome","GLOBAL",1) 
    ActionOverride("Mazzy",SetGlobal("KickedOut","LOCALS",1)) 
    ActionOverride("Mazzy",SetLeavePartyDialogFile()) 
    ActionOverride("Mazzy",ChangeAIScript("",DEFAULT)) 
    ActionOverride("Mazzy",LeaveParty())
    ActionOverride("Mazzy",GivePartyAllEquipment())
    ActionOverride("Mazzy",MakeGlobal())
    Wait(1)
    CreateVisualEffectObject("SPDIMNDR","Mazzy")
    Wait(4)
    MoveGlobal("AR2002","Mazzy",[424.335])~ EXIT
+ ~InParty("Minsc") InMyArea("Minsc") !StateCheck("Minsc",CD_STATE_NOTVALID)~ + @11 DO ~SetGlobal("B!MinscSentHome","GLOBAL",1) 
    ActionOverride("Minsc",SetGlobal("KickedOut","LOCALS",1)) 
    ActionOverride("Minsc",SetLeavePartyDialogFile()) 
    ActionOverride("Minsc",ChangeAIScript("",DEFAULT)) 
    ActionOverride("Minsc",LeaveParty())
    ActionOverride("Minsc",GivePartyAllEquipment())
    ActionOverride("Minsc",MakeGlobal())
    Wait(1)
    CreateVisualEffectObject("SPDIMNDR","Minsc")
    Wait(4)
    MoveGlobal("AR0406","Minsc",[1145.1404])~ EXIT
+ ~InParty("Nalia") InMyArea("Nalia") !StateCheck("Nalia",CD_STATE_NOTVALID)~ + @12 DO ~SetGlobal("B!NaliaSentHome","GLOBAL",1) 
    ActionOverride("Nalia",SetGlobal("KickedOut","LOCALS",1)) 
    ActionOverride("Nalia",SetLeavePartyDialogFile()) 
    ActionOverride("Nalia",ChangeAIScript("",DEFAULT)) 
    ActionOverride("Nalia",LeaveParty())
    ActionOverride("Nalia",GivePartyAllEquipment())
    ActionOverride("Nalia",MakeGlobal())
    Wait(1)
    CreateVisualEffectObject("SPDIMNDR","Nalia")
    Wait(4)
    MoveGlobal("AR1306","Nalia",[1064.901])~ EXIT
+ ~InParty("Sarevok") InMyArea("Sarevok") !StateCheck("Sarevok",CD_STATE_NOTVALID)~ + @13 DO ~SetGlobal("B!SarevokSentHome","GLOBAL",1) 
    ActionOverride("Sarevok",SetGlobal("KickedOut","LOCALS",1)) 
    ActionOverride("Sarevok",SetLeavePartyDialogFile()) 
    ActionOverride("Sarevok",ChangeAIScript("",DEFAULT)) 
    ActionOverride("Sarevok",LeaveParty())
    ActionOverride("Sarevok",GivePartyAllEquipment())
    ActionOverride("Sarevok",MakeGlobal())
    Wait(1)
    CreateVisualEffectObject("SPDIMNDR","Sarevok")
    Wait(4)
    MoveGlobal("AR0900","Sarevok",[2003.040])~ EXIT
+ ~InParty("Valygar") InMyArea("Valygar") !StateCheck("Valygar",CD_STATE_NOTVALID)~ + @14 DO ~SetGlobal("B!ValygarSentHome","GLOBAL",1) 
    ActionOverride("Valygar",SetGlobal("KickedOut","LOCALS",1)) 
    ActionOverride("Valygar",SetLeavePartyDialogFile()) 
    ActionOverride("Valygar",ChangeAIScript("",DEFAULT)) 
    ActionOverride("Valygar",LeaveParty())
    ActionOverride("Valygar",GivePartyAllEquipment())
    ActionOverride("Valygar",MakeGlobal())
    Wait(1)
    CreateVisualEffectObject("SPDIMNDR","Valygar")
    Wait(4)
    MoveGlobal("AR1101","Valygar",[402.338])~ EXIT
+ ~InParty("Viconia") InMyArea("Viconia") !StateCheck("Viconia",CD_STATE_NOTVALID)~ + @15 DO ~SetGlobal("B!ViconiaSentHome","GLOBAL",1) 
    ActionOverride("Viconia",SetGlobal("KickedOut","LOCALS",1)) 
    ActionOverride("Viconia",SetLeavePartyDialogFile()) 
    ActionOverride("Viconia",ChangeAIScript("",DEFAULT)) 
    ActionOverride("Viconia",LeaveParty())
    ActionOverride("Viconia",GivePartyAllEquipment())
    ActionOverride("Viconia",MakeGlobal())
    Wait(1)
    CreateVisualEffectObject("SPDIMNDR","Viconia")
    Wait(4)
    MoveGlobal("AR0800","Viconia",[498.1089])~ EXIT
+ ~Global("B!AerieSentHome","GLOBAL",1)~ + @16 DO ~CreateVisualEffect("SPPORTAL",[1999.1228]) 
    Wait(2)
    MoveGlobal("AR4500","Aerie",[1999.1228])
    Wait(1)~ + 8
+ ~Global("B!AnomenSentHome","GLOBAL",1)~ + @17 DO ~CreateVisualEffect("SPPORTAL",[1999.1228]) 
    Wait(2)
    MoveGlobal("AR4500","Anomen",[1999.1228])
    Wait(1)~ + 8
+ ~Global("B!CerndSentHome","GLOBAL",1)~ + @18 DO ~CreateVisualEffect("SPPORTAL",[1999.1228]) 
    Wait(2)
    MoveGlobal("AR4500","Cernd",[1999.1228])
    Wait(1)~ + 8
+ ~Global("B!EdwinSentHome","GLOBAL",1)~ + @19 DO ~CreateVisualEffect("SPPORTAL",[1999.1228]) 
    Wait(2)
    MoveGlobal("AR4500","Edwin",[1999.1228])
    Wait(1)~ + 8
+ ~Global("B!HaerDalisSentHome","GLOBAL",1)~ + @20 DO ~CreateVisualEffect("SPPORTAL",[1999.1228]) 
    Wait(2)
    MoveGlobal("AR4500","HaerDalis",[1999.1228])
    Wait(1)~ + 8
+ ~Global("B!Imoen2SentHome","GLOBAL",1)~ + @21 DO ~CreateVisualEffect("SPPORTAL",[1999.1228]) 
    Wait(2)
    MoveGlobal("AR4500","Imoen2",[1999.1228])
    Wait(1)~ + 8
+ ~Global("B!JaheiraSentHome","GLOBAL",1)~ + @22 DO ~CreateVisualEffect("SPPORTAL",[1999.1228]) 
    Wait(2)
    MoveGlobal("AR4500","Jaheira",[1999.1228])
    Wait(1)~ + 8
+ ~Global("B!JanSentHome","GLOBAL",1)~ + @23 DO ~CreateVisualEffect("SPPORTAL",[1999.1228]) 
    Wait(2)
    MoveGlobal("AR4500","Jan",[1999.1228])
    Wait(1)~ + 8
+ ~Global("B!KeldornSentHome","GLOBAL",1)~ + @24 DO ~CreateVisualEffect("SPPORTAL",[1999.1228]) 
    Wait(2)
    MoveGlobal("AR4500","Keldorn",[1999.1228])
    Wait(1)~ + 8
+ ~Global("B!KorganSentHome","GLOBAL",1)~ + @25 DO ~CreateVisualEffect("SPPORTAL",[1999.1228]) 
    Wait(2)
    MoveGlobal("AR4500","Korgan",[1999.1228])
    Wait(1)~ + 8
+ ~Global("B!MazzySentHome","GLOBAL",1)~ + @26 DO ~CreateVisualEffect("SPPORTAL",[1999.1228]) 
    Wait(2)
    MoveGlobal("AR4500","Mazzy",[1999.1228])
    Wait(1)~ + 8
+ ~Global("B!MinscSentHome","GLOBAL",1)~ + @27 DO ~CreateVisualEffect("SPPORTAL",[1999.1228]) 
    Wait(2)
    MoveGlobal("AR4500","Minsc",[1999.1228])
    Wait(1)~ + 8
+ ~Global("B!NaliaSentHome","GLOBAL",1)~ + @28 DO ~CreateVisualEffect("SPPORTAL",[1999.1228]) 
    Wait(2)
    MoveGlobal("AR4500","Nalia",[1999.1228])
    Wait(1)~ + 8
+ ~Global("B!SarevokSentHome","GLOBAL",1)~ + @29 DO ~CreateVisualEffect("SPPORTAL",[1999.1228]) 
    Wait(2)
    MoveGlobal("AR4500","Sarevok",[1999.1228])
    Wait(1)~ + 8 
+ ~Global("B!ValygarSentHome","GLOBAL",1)~ + @30 DO ~CreateVisualEffect("SPPORTAL",[1999.1228]) 
    Wait(2)
    MoveGlobal("AR4500","Valygar",[1999.1228])
    Wait(1)~ + 8
+ ~Global("B!ViconiaSentHome","GLOBAL",1)~ + @31 DO ~CreateVisualEffect("SPPORTAL",[1999.1228]) 
    Wait(2)
    MoveGlobal("AR4500","Viconia",[1999.1228])
    Wait(1)~ + 8
END
